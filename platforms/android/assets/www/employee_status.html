<!DOCTYPE HTML>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/splash/splash-icon.png">
<link rel="apple-touch-startup-image" href="images/splash/splash-screen.png"            media="screen and (max-device-width: 320px)" />  
<link rel="apple-touch-startup-image" href="images/splash/splash-screen@2x.png"         media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" /> 
<link rel="apple-touch-startup-image" sizes="640x1096" href="images/splash/splash-screen@3x.png" />
<link rel="apple-touch-startup-image" sizes="1024x748" href="images/splash/splash-screen-ipad-landscape" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
<link rel="apple-touch-startup-image" sizes="768x1004" href="images/splash/splash-screen-ipad-portrait.png" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
<link rel="apple-touch-startup-image" sizes="1536x2008" href="images/splash/splash-screen-ipad-portrait-retina.png"   media="(device-width: 768px)  and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)"/>
<link rel="apple-touch-startup-image" sizes="1496x2048" href="images/splash/splash-screen-ipad-landscape-retina.png"   media="(device-width: 768px) and (orientation: landscape)    and (-webkit-device-pixel-ratio: 2)"/>

<title>Netstratum HRM</title>

<link href="css/custom.css"           rel="stylesheet" type="text/css">
<link href="css/colors/black.css"     rel="stylesheet" type="text/css">
<link href="css/framework.css"       rel="stylesheet" type="text/css">
<link href="css/owl.carousel.css"     rel="stylesheet" type="text/css">
<link href="css/owl.theme.css"       rel="stylesheet" type="text/css">
<link href="css/swipebox.css"         rel="stylesheet" type="text/css">
<link href="css/colorbox.css"         rel="stylesheet" type="text/css">
<link href="css/dataTables.responsive.css"         rel="stylesheet" type="text/css">
 <link rel="stylesheet" href="http://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
   <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/jqueryui.js"></script>
<script type="text/javascript" src="js/owl.carousel.min.js"></script>
<script type="text/javascript" src="js/jquery.swipebox.js"></script>
<script type="text/javascript" src="js/colorbox.js"></script>
<script type="text/javascript" src="js/snap.js"></script>
<script type="text/javascript" src="js/contact.js"></script>
<script type="text/javascript" src="js/custom.js"></script>
<script type="text/javascript" src="js/framework.js"></script>
 <script src="js/jquery.validate.min.js" ></script>
<script type="text/javascript" src="js/framework.launcher.js"></script>
  <script src="http://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
<script type="text/javascript" src="http://cdn.datatables.net/1.10.7/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="http://cdn.datatables.net/responsive/1.0.6/js/dataTables.responsive.js"></script>
<script type="text/javascript" src="http://cdn.datatables.net/plug-ins/1.10.7/pagination/four_button.js"></script>
<script type="text/javascript" src="PushNotification.js"></script>
  <script src="js/appconfig.js"></script>
</head>
<body>

<div id="preloader">
    <div id="status">
        <p class="center-text">
            Loading the content...
            <em>Loading depends on your connection speed!</em>
        </p>
    </div>
</div>


<div class="all-elements">
    <div id="sidebar" class="page-sidebar">
        <div class="page-sidebar-scroll">
            <div class="sidebar-controls">
                <a href="tel:04843193383" class="sidebar-call"></a>
                
                
                <a href="#" class="sidebar-twit" id="logout_app"></a>
                <a href="#" class="sidebar-close"></a>
            </div>  
 
            <div class="sidebar-header">
                <img class="sidebar-logo round-decoration" src="images/general-nature/8s.jpg" alt="img" id="userprofimg">
                <h4 class="center-text" id="dispname"></h4>
                <em class="center-text">Welcome</em>
            </div>
            
            
            
            <div class="navigation-items" id="main-menu">
               <div class="nav-item">
                    <a href="dashboard_index.html" >Home</a>
                </div>
                 <div class="sidebar-decoration"></div>                                                                                                        
            </div>    
            
            
            
            <div id="home" style="display:none;" >
              <div id="app-status-div">
                <ul id="app-status-ul">

                </ul>
              </div>
            </div>                                    
            
            
            <p class="sidebar-copyright center-text">Netstratum Â© 2015</p>
                    
        </div>
    </div>


    <div id="content" class="page-content">
        <div class="content-controls solid-color fixed-header">
            <a href="#" class="deploy-sidebar"></a>
            <a href="dashboard_index.html" class="for-dash"></a>
            <em style="display: none;" id="emplstatus" class="content-title">EMPLOYEE STATUS</em>
            <em style="display: none;" id="sublstatus" class="content-title">SUBORDINATE STATUS</em>
            <a href="mailto:hr@netstratum.com" class="deploy-contact"></a>
        </div>
      
        <div class="fixed-header-clear"></div>
      
        
       
        
 
        <div class="content content-height" id="employeeleavestatus">
        <div class="one-half-responsive">
         <div class="container no-bottom">
          <div class="contact-form no-bottom"> 
         <h4></h4>
          
          
           </div>
        </div>
        </div>
           
        
       
        
               
        
       
       
         <div class="container no-bottom">
          <div class="contact-form no-bottom"> 
              
                      <fieldset><div class="formFieldWrap">
                                    <select name="leave_status_report" id="leave_status_report" class="select-style">
                                         <option value="">Select All</option>
                                         <option value="pending" selected="selected">Pending</option>
                                         <option value="taken">Taken</option>
                                         <option value="reject">Rejected</option>
                                         <option value="approve">Scheduled</option>
                                         <option value="cancel">Cancelled</option>
                                     </select>
                                </div>
                      </fieldset>
            
            <table id="reporttable" class="display no-wrap dataTable dtr-inline" cellspacing="0" width="100%" role="grid" style="width: 100%;" >          
                <thead>
                    <tr>
                        <th>Employee Name</th>
                        <th>Leave Type</th>
                        <th>From Date</th>
                        <th>To Date</th>
                        <th>Reason</th>
                        <th>Days</th>
                        <th>Status</th>  
                        <th>Options</th>
                    </tr>
                </thead>
            </table>
            </div>
        </div>
        
            </div>

        <div style="display:none;" class="modal fade popup" id="leaveApprove" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <form action="#" id="leaveApproveform" method="POST">
                <div class="row">
                        <div class="col-md-12">
                            <div class="panel panel-primary" data-collapsed="0">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                  <div class="modal-header">
                                    
                                    <h4 align="center" class="modal-title" id="leaveApprove_head"></h4>
                                  </div>
                                  <div class="modal-body">
                                    <div class="form-group">
                                        <b><div for="leave" class="right span4" style="float:left;">Leave Type:</div></b>
                                        <div class="col-sm-5" id="approve_leave_type" style="float:left;"></div>
                                    </div>
                                    <div class="form-group" >
                                        <b><div for="leave" class="right span4" style="float:left;">Leave Date:</div></b>
                                        <div class="col-sm-5" id="approve_leave_date" style="float:left;"></div>
                                        <input type="hidden" name="approve_leave_id" id="approve_leave_id" value="">
                                    </div>
                                    <div class="form-group">
                                        <b><div for="leave" class="right span4" style="float:left;">Reason:</div></b>
                                        <div class="col-sm-5" style="float:left;">
                                            <textarea id="leave_approve_text" name="leave_approve_text" class="contactTextarea" value=""></textarea>
                                        </div>
                                    </div>
                                  </div>
                                  <div class="modal-footer">                                
                                    <input type="button" id="approvepopupbtn" name="approvepopupbtn" class='buttonWrap button button-green contactSubmitButton' value="Cancel Leave">                                 
                                  </div>
                                </div>
                            </div> 
                            </div>
                        </div>
                        </div>
            </form>
            
        </div>
        
        
            <div class="content">
            <div class="container">
                <div class="footer-socials">
                    <a href="https://www.facebook.com/netstratum" class="facebook-footer"></a>                    
                    <a href="https://twitter.com/netstratum" class="twitter-footer"></a>
                </div>
                   <p class="copyright uppercase center-text no-bottom">Netstratum Â© 2015<br> All rights reserved</p>     
            </div>
        </div>
    </div>  
</div>

</body>
</html>

<script type="text/javascript">
var employeeno = localStorage.getItem("empno");



 $(document).ready(function() {
     getMenu('employee_status');
 
    
     
     
     
     if(window.location.hash==="#leavestatus") {
              var myleaveid = localStorage.getItem("leaveid");
              $('#leave_status_report').val("");
            }
            else{
                var myleaveid = "";
            }
               //var leaveid="";
                 var leaveid_approve = "";
                 var approval_status_text = "";
                if(roleid=== '1' || roleid==='2')                                      
                    jQuery('#emplstatus').show();                 
                 else 
                 {
                    jQuery('#sublstatus').show();                          
                    var ptr = jQuery("#reporttable").find("tr");
                    ptr.find("th:last").remove();
                 }  
 
 lreport = jQuery('#reporttable').DataTable({
                   ajax: { "url":SITEURL+"index.php?r=Leave/Allreport_app",
                    data: function ( d ) {
                          d.emponoall = employeeno;
                          d.user_role = roleid;
                          d.leave_status = jQuery('#leave_status_report').val();
                          d.myleaveid = myleaveid;
                        }
                      },
                    "serverSide": true,         
                   "lengthChange": false,
                   
                   responsive: true,
                    "searching": false,
                    "bInfo": false,
                    "sPaginationType": "four_button"
                     
               });
        
    jQuery('#leave_status_report').change(function(){

                  lreport.draw();

               });
               
               
              jQuery('#employeeleavestatus').on('change','.approve',function(){
                  
              if ($(".approve").val()=="Select---")
                return false;

               //$('#leaveApprove').popup().popup('open');
               //$('#leaveApprove').show();
               $( "#leaveApprove" ).dialog();
                approve_leave_id = jQuery(this).attr('id');
                var title = jQuery(this).val().charAt(0).toUpperCase()+ jQuery(this).val().slice(1);
                approval_status_text = jQuery(this).val();
                jQuery('#leaveApprove_head').html(title+' Leave');
                jQuery('#approvepopupbtn').val(title+' Leave');                
               jQuery.ajax({
                 type:"POST",
                 url:SITEURL+"index.php?r=Leave/Approve_show",
                 data:{leaveid:jQuery(this).attr('id'),approve_type:jQuery(this).val()}
                 
               }).done(function(msg)
               {
                    var dataval = JSON.parse(msg);

                   jQuery('#approve_leave_id').val(approve_leave_id);
                   jQuery('#approve_leave_type').html(dataval.name);
                   jQuery('#approve_leave_date').html(dataval.start_date+" - "+dataval.end_date);                       
                     leaveid_approve = jQuery('#approve_leave_id').val();   


                   //lreport.fnDraw();

               }); 
               
            });
   
            jQuery('#approvepopupbtn').click(function(){
                            jQuery('#leaveApproveform').submit();
                         });
                         
             jQuery('#leaveApproveform').validate({
                              submitHandler: function(form){
                                  $('#approvepopupbtn').prop("disabled", true);
                                  $('#approvepopupbtn').val("processing...");
                                  var leave_remarks = jQuery('#leave_approve_text').val();
                                  jQuery.ajax({
                                     type:"POST",
                                     url:SITEURL+"index.php?r=Leave/Approve_app",
                                     data:{'leaveid':leaveid_approve,'leave_approve_text':leave_remarks,
                                         'approve_type':approval_status_text,user_role:roleid,emponoall:employeeno,
                                         "params":jQuery(form).serialize(),username:name}
                                   }).done(function(msg){
                          
                          if (approval_status_text ==='approve')
                            var approve_msg = 'Approved';
                          else
                            var approve_msg = 'Rejected';

                          
                         setTimeout(
                                 function(){
                               lreport.draw();
                               jQuery('#approvereset').trigger('click');
                               //jQuery('#leaveApprove').popup().popup('close'); 
                               $('#leave_approve_text').val("");
                               $('#approvepopupbtn').prop("disabled", false);
                               
                               $('#leaveApprove').dialog( "close" );
                                 },500);                                                                
                            });                                  
                              }
                          });             
                         
} );
</script>























